---
title: "Modelos Lineares I"
subtitle: "Exercicio 1"
author: "Rodrigo Barbosa"
date: "2023-11-10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
library(tidyverse)
library(ggplot2)
library(knitr)

# Defina a família de fontes globalmente
# theme_set(theme_bw(base_family = "Arial"))
```


insert chunk => ctrl + alt + i

**principais argumentos dos chunks**

*include = FALSE prevents code and results from appearing in the finished file. R Markdown             still runs the code in the chunk, and the results can be used by other chunks.

*echo = FALSE prevents code, but not the results from appearing in the finished file. This          is a useful way to embed figures.

*message = FALSE prevents messages that are generated by code from appearing in the finished            file.

*warning = FALSE prevents warnings that are generated by code from appearing in the                    finished.

*fig.cap = "..." adds a caption to graphical results.

```{r include=FALSE, message=FALSE}
t <- seq(10)
x <- seq(10, 28, 2)
y <- c(250, 235, 250, 248, 220, 205, 200, 210, 200, 190)

df = tibble(t,x,y)

df <- df %>% 
  mutate(r = x*y)

df
```


```{r, echo=FALSE}
sm = summary(df)
sm
kable(sm, caption='teste')

df %>%
  summarise(n = n(),
            min = min(r),
            max = max(r),
            Q1 = quantile(r, 0.25),
            Q2 = quantile(r, 0.5),
            Q3 = quantile(r, 0.75),
            media = mean(r),
            sd = round(sd(r), 2)) |> 
  kable(caption='Estatística descritiva para a Renda',
        col.names = c("n",
                      "Min",
                      "Max",
                      "$Q_1$",
                      "$Q_2$",
                      "$Q_3$",
                      "$\\bar{X}$",
                      "$\\sigma$"))
```

# Questão A
```{r echo=FALSE}
fig.1 <- df %>% 
  ggplot(aes(x=t, y=r))+
  geom_line(col='green')+
  geom_point(size=2)+
  labs(caption='Figura 1: ')+
  theme(plot.title=element_text(hjust=0.5),
        plot.caption = element_text(hjust=0))+
  theme_test()

fig.1
```


#a)
```{r}
summary(df)
```


# Questão B
```{r echo=FALSE}
fit.1 <- lm(r~t, data=df)
fit.1$coefficients

fig.1+
  geom_smooth(method=lm,se=FALSE,col="2")
```

## Modelo de regressão linear básico com apenas uma variável regressora: ##



$$
  Y_i = \beta_0 + \beta_1X_i + \epsilon_i
$$

## Modelo com os parâmetros $\beta_0$ e $\beta_1$ estimados: ##



$$
  Y_i = 2374.9333 + 310.1576X_i + \epsilon_i
$$

# Questão C
```{r}
plot(df$t, df$r)
abline(fit.1$coefficients, col='red')
```

```{r}
plot(fit.1$residuals)
abline(0,0,col='red')
```

# Questão D
```{r}
summary(fit.1)
confint(fit.1, level = 0.95)
```

# Para cada mês adicional, a receita aumenta, em média, em R$ 310, podendo variar entre R$ 259 a R$ 362

# Questão E
```{r}
novos_meses <- tibble(t=c(11, 12))
predict(fit.1, newdata = novos_meses)
```
