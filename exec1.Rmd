---
title: "Modelos Lineares I"
subtitle: "Exercicio 1"
author: "Rodrigo Barbosa"
date: "2023-11-10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# insert chunk => ctrl + alt + i

**principais argumentos dos chunks**

*include = FALSE prevents code and results from appearing in the finished file. R Markdown             still runs the code in the chunk, and the results can be used by other chunks.

*echo = FALSE prevents code, but not the results from appearing in the finished file. This          is a useful way to embed figures.

*message = FALSE prevents messages that are generated by code from appearing in the finished            file.

*warning = FALSE prevents warnings that are generated by code from appearing in the                    finished.

*fig.cap = "..." adds a caption to graphical results.

```{r include=FALSE, message=FALSE}
library(tidyverse)
library(knitr)

t <- seq(10)
x <- seq(10, 28, 2)
y <- c(250, 235, 250, 248, 220, 205, 200, 210, 200, 190)

df = tibble(t,x,y)

df <- df %>% 
  mutate(r = x*y)

df
```

## Including Plots

```{r, echo=FALSE}
sm = summary(df)
sm
kable(sm, caption='teste')

df %>%
  summarise(n = n(),
            min = min(r),
            max = max(r),
            Q1 = quantile(r, 0.25),
            Q2 = quantile(r, 0.5),
            Q3 = quantile(r, 0.75),
            media = mean(r),
            sd = sd(r)) |> 
  kable(caption='Estatística descritiva para a Renda')
```


```{r}
df %>% 
  ggplot(aes(x=t, y=r))+
  geom_line(col='green')+
  geom_point()
```

# Exercício 1
#a)
```{r}
summary(df)
```


#b)
```{r}
model2 <- lm(r~t, data=df)
model2$coefficients
```


# Y = 2374.9333 + 310.1576 * X

#c)
```{r}
plot(df$t, df$r)
abline(model2$coefficients, col='red')
```

```{r}
plot(model2$residuals)
abline(0,0,col='red')
```

#d)
```{r}
summary(model2)
confint(model2, level = 0.95)
```

# Para cada mês adicional, a receita aumenta, em média, em R$ 310, podendo variar entre R$ 259 a R$ 362

#e)
novos_meses <- tibble(t=c(11, 12))
predict(model2, newdata = novos_meses)